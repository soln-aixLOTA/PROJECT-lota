<!-- Einstein AI Demo Component -->
<template>
    <div class="slds-card">
        <!-- Header -->
        <div class="slds-card__header slds-grid">
            <header class="slds-media slds-media_center slds-has-flexi-truncate">
                <div class="slds-media__figure">
                    <lightning-icon icon-name="utility:einstein" size="medium"></lightning-icon>
                </div>
                <div class="slds-media__body">
                    <h2 class="slds-card__header-title">
                        <span class="slds-text-heading_medium">Einstein AI Capabilities</span>
                    </h2>
                </div>
            </header>
        </div>

        <!-- Body -->
        <div class="slds-card__body slds-card__body_inner">
            <!-- Tabs Container -->
            <lightning-tabset variant="scoped">
                <!-- Text Generation Tab -->
                <lightning-tab label="Text Generation" icon-name="utility:chat">
                    <div class="slds-p-around_medium">
                        <lightning-textarea name="prompt" label="Enter your prompt"
                            placeholder="Type your prompt here..." value={textInput} onchange={handleTextInputChange}>
                        </lightning-textarea>

                        <div class="slds-grid slds-gutters slds-p-top_medium">
                            <div class="slds-col">
                                <lightning-slider label="Max Tokens" value={maxTokens} min="1" max="2048"
                                    onchange={handleMaxTokensChange}>
                                </lightning-slider>
                            </div>
                            <div class="slds-col">
                                <lightning-slider label="Temperature" value={temperature} min="0" max="1" step="0.1"
                                    onchange={handleTemperatureChange}>
                                </lightning-slider>
                            </div>
                        </div>

                        <div class="slds-p-top_medium">
                            <lightning-button-group>
                                <lightning-button label="Generate Text" variant="brand" onclick={handleGenerateText}
                                    disabled={isLoading}>
                                </lightning-button>
                                <lightning-button label="Clear" onclick={handleClear} disabled={isLoading}>
                                </lightning-button>
                            </lightning-button-group>
                        </div>

                        <template if:true={generatedText}>
                            <div class="slds-box slds-theme_default slds-m-top_medium">
                                <div class="slds-text-heading_small slds-p-bottom_small">Generated Text:</div>
                                <lightning-formatted-rich-text value={generatedText}></lightning-formatted-rich-text>
                            </div>
                        </template>
                    </div>
                </lightning-tab>

                <!-- Sentiment Analysis Tab -->
                <lightning-tab label="Sentiment Analysis" icon-name="utility:sentiment_positive">
                    <div class="slds-p-around_medium">
                        <lightning-textarea name="sentimentText" label="Enter text to analyze"
                            placeholder="Type or paste text here..." value={textInput} onchange={handleTextInputChange}>
                        </lightning-textarea>

                        <div class="slds-p-top_medium">
                            <lightning-button label="Analyze Sentiment" variant="brand" onclick={handleAnalyzeSentiment}
                                disabled={isLoading}>
                            </lightning-button>
                        </div>

                        <template if:true={sentimentResult}>
                            <div class="slds-box slds-theme_default slds-m-top_medium">
                                <div class="slds-grid slds-gutters">
                                    <div class="slds-col">
                                        <div class="slds-text-title">Sentiment:</div>
                                        <div class={formattedSentimentResult.color}>
                                            {formattedSentimentResult.label}
                                        </div>
                                    </div>
                                    <div class="slds-col">
                                        <div class="slds-text-title">Confidence:</div>
                                        <div class="slds-text-body_regular">
                                            {formattedSentimentResult.score}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </lightning-tab>

                <!-- Image Analysis Tab -->
                <lightning-tab label="Image Analysis" icon-name="utility:image">
                    <div class="slds-p-around_medium">
                        <lightning-input type="url" label="Image URL" placeholder="Enter image URL..." value={imageUrl}
                            onchange={handleImageUrlChange}>
                        </lightning-input>

                        <template if:true={imageUrl}>
                            <div class="slds-p-top_medium slds-align_absolute-center">
                                <img src={imageUrl} alt="Preview" style="max-width: 300px; max-height: 300px;" />
                            </div>
                        </template>

                        <div class="slds-p-top_medium">
                            <lightning-button label="Analyze Image" variant="brand" onclick={handleAnalyzeImage}
                                disabled={isLoading}>
                            </lightning-button>
                        </div>

                        <template if:true={imageAnalysisResult}>
                            <div class="slds-box slds-theme_default slds-m-top_medium">
                                <div class="slds-text-heading_small slds-p-bottom_small">Analysis Results:</div>
                                <template for:each={formattedImageAnalysisResult} for:item="prediction">
                                    <div key={prediction.label} class="slds-grid slds-gutters slds-p-bottom_xx-small">
                                        <div class="slds-col slds-size_2-of-3">
                                            <div class="slds-text-body_regular">{prediction.label}</div>
                                        </div>
                                        <div class="slds-col slds-size_1-of-3">
                                            <div class="slds-text-body_regular">{prediction.probability}</div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </template>
                    </div>
                </lightning-tab>

                <!-- Chat Tab -->
                <lightning-tab label="Chat" icon-name="utility:chat">
                    <div class="slds-p-around_medium">
                        <div class="chat-container slds-box slds-theme_default">
                            <template for:each={chatMessages} for:item="message">
                                <div key={message.id} class={message.containerClass}>
                                    <div class={message.messageClass}>
                                        <div class="slds-text-body_regular">{message.content}</div>
                                        <div class="slds-text-body_small slds-text-color_weak">
                                            {message.timestamp}
                                        </div>
                                    </div>
                                </div>
                            </template>
                        </div>

                        <div class="slds-p-top_medium">
                            <lightning-textarea name="chatInput" placeholder="Type your message..." value={chatInput}
                                onchange={handleChatInputChange} onkeypress={handleChatKeyPress}>
                            </lightning-textarea>

                            <div class="slds-p-top_small">
                                <lightning-button-group>
                                    <lightning-button label="Send" variant="brand" onclick={handleSendChat}
                                        disabled={isLoading}>
                                    </lightning-button>
                                    <lightning-button label="Clear Chat" onclick={handleClearChat} disabled={isLoading}>
                                    </lightning-button>
                                </lightning-button-group>
                            </div>
                        </div>
                    </div>
                </lightning-tab>
            </lightning-tabset>
        </div>

        <!-- Loading Spinner -->
        <template if:true={isLoading}>
            <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
        </template>

        <!-- Footer -->
        <footer class="slds-card__footer">
            <div class="slds-text-body_small slds-text-color_weak">
                Powered by Einstein AI
            </div>
        </footer>
    </div>
</template>